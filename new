private static Mat ToMat(List<ScanPointXYZ> points)
{
    var m = new Mat(points.Count, 3, MatType.CV_64FC1);
    for (int i = 0; i < points.Count; i++) { var p = points[i]; m.Set(i, 0, p.X); m.Set(i, 1, p.Y); m.Set(i, 2, p.Z); }
    return m;
}