using System.Windows;
using System.Windows.Media.Media3D;

public static class PointCloudRegionOps
{
    /// <summary>
    /// Returns a new point cloud containing only the points whose (X, Y)
    /// lie inside the given 2D rectangle (in the XY plane).
    /// </summary>
    /// <param name="points">Input point cloud.</param>
    /// <param name="rect">
    /// Rectangle in XY coordinates. A point is kept if (X, Y) is inside this rect.
    /// </param>
    /// <returns>Filtered Point3DCollection.</returns>
    public static Point3DCollection ClipToRectangleXY(
        Point3DCollection points,
        Rect rect)
    {
        var result = new Point3DCollection();

        if (points == null || points.Count == 0)
            return result;

        foreach (var p in points)
        {
            // Check inclusion in the XY rectangle
            if (rect.Contains(new Point(p.X, p.Y)))
            {
                result.Add(p);
            }
        }

        return result;
    }
}